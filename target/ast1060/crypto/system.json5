// Licensed under the Apache-2.0 license

// ASPEED AST1060 Crypto Service Configuration (QEMU)
// ARM Cortex-M3 (soft-float ABI for QEMU compatibility)
//
// Memory Layout:
//   0x00000000 - 0x000004A0: Vector table + kernel annotations (1184 bytes)
//   0x000004A0 - 0x00020000: Kernel code (~126KB)
//   0x00020000 - 0x00040000: Crypto client test app (128KB)
//   0x00040000 - 0x00060000: Crypto server app (128KB)
//   0x00060000 - 0x00080000: Kernel RAM (128KB)
//   0x00080000 - 0x000A0000: App RAM (128KB total)
//
// Total: ~640KB, fits within AST1060's 768KB SRAM.
{
    arch: {
        type: "armv7m",
        vector_table_start_address: 0x00000000,
        vector_table_size_bytes: 1184,  // 0x4A0 (272 vectors + thread/stack annotations)
    },
    kernel: {
        flash_start_address: 0x000004A0,  // After vector table + annotations
        flash_size_bytes: 129888,         // ~126KB (ends at 0x00020000, power-of-2 boundary)
        ram_start_address: 0x00060000,    // After all flash regions (power-of-2 aligned)
        ram_size_bytes: 131072,           // 128KB
    },
    apps: [
        {
            name: "crypto_client",
            flash_size_bytes: 131072,     // 128KB for client test app
            ram_size_bytes: 32768,        // 32KB RAM
            process: {
                name: "crypto_client_process",
                objects: [
                    {
                        name: "CRYPTO",
                        type: "channel_initiator",
                        handler_app: "crypto_server",
                        handler_object_name: "CRYPTO",
                    }
                ],
                threads: [
                    {
                        name: "crypto_client_thread",
                        stack_size_bytes: 8192,  // 8KB stack for crypto ops
                    },
                ],
            },
        },
        {
            name: "crypto_server",
            flash_size_bytes: 131072,     // 128KB for server (RustCrypto is large)
            ram_size_bytes: 65536,        // 64KB RAM for crypto contexts
            process: {
                name: "crypto_server_process",
                objects: [
                    {
                        name: "CRYPTO",
                        type: "channel_handler",
                    },
                ],
                threads: [
                    {
                        name: "crypto_server_thread",
                        stack_size_bytes: 8192,  // 8KB stack for crypto ops
                    },
                ],
            },
        },
    ],
}
